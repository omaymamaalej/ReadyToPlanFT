<nb-card 
  class="modern-dialog"
  [ngStyle]="{
    width: isSlideshow ? '100vw' : '1200px',
    height: isSlideshow ? '100vh' : '90vh' }">

  <nb-card-header class="modern-dialog-header">
    <h3>ğŸ“ Course Presentation</h3>
    <div class="header-actions">
      <button nbButton ghost status="primary" (click)="downloadPresentation()">
        <nb-icon icon="download-outline"></nb-icon> Download PPTX
      </button>

      <!-- Icon tic visible uniquement si mode regenerate -->
      <nb-icon 
        *ngIf="isTemporary"
        icon="checkmark-outline"
        class="save-tic"
        title="Save Presentation"
        (click)="confirmSavePresentation()">
      </nb-icon>

      <nb-icon 
        [icon]="isSlideshow ? 'collapse-outline' : 'expand-outline'" 
        class="slideshow-toggle" 
        (click)="toggleSlideshow()"
        [title]="isSlideshow ? 'Exit Fullscreen' : 'Enter Fullscreen'">
      </nb-icon>
      <nb-icon 
        icon="close-outline" 
        class="close-icon" 
        (click)="close()" 
        title="Close">
      </nb-icon>
    </div>
  </nb-card-header>

  <nb-card-body class="slides-container">
    <!-- Sidebar des slides -->
    <div class="slides-sidebar">
      <div *ngFor="let slide of presentationSlidesRaw; let i = index"
          class="slide-thumb"
          [class.active]="i === currentSlideIndex"
          (click)="goToSlide(i)">
        <div class="slide-number">Slide {{ i + 1 }}</div>
        <p class="slide-title">{{ getSlideTitleFromRaw(slide) }}</p>
      </div>
    </div>

    <!-- Vue principale des slides -->
    <div class="slides-view">
      <div class="slide-wrapper">
        <div class="slide-content" [innerHTML]="presentationSlidesHtml[currentSlideIndex]"></div>
        <div class="slide-footer">
          <span class="page-number">Page {{ getPageNumber() }}</span>
        </div>
      </div>
    </div>
  </nb-card-body>

  <!-- plus de footer -->
  <div class="slide-navigation-hint" *ngIf="isSlideshow">
    â† Previous | Next â†’ 
  </div>
</nb-card>
